{"version":3,"sources":["controllers-flyone.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","rentalcarsIframeCtrl","$scope","$sce","backend","$route","ROUTES","getFlightData","vm","orderInfo","plainFlights","constructUrl","params","newUrl","Object","keys","map","key","baseRentalCarsUrl","this","DEFAULT_PARAMS","affiliateCode","pickupIATACode","prefcurrency","pickupHour","pickUpMinute","returnHour","returnMinute","pickupDate","pickupMonth","pickupYear","returnDate","returnMonth","returnYear","preflang","results","SHOW_ON_PAGES","CONFIRM_ORDER","SEARCH_ORDER","SEARCH_ORDER_WITH_PARAMS","showRentalCarsIframe","destionation","$onInit","header","status","_","contains","current","$$route","originalPath","newParams","clone","firstFlight","firstFlightDate","arrivaldate","split","destCity","destinationcity","destPort","destinationport","ready","then","sessionParams","lang","app","angular","filter","url","trustAsResourceUrl","component","controllerAs","bindings","templateUrl","controller","2","hasSpaBrandsController","brandList","searchResult","brandsList","$watch","thereIsSPABrands","reduce","acc","brand","name","indexOf","directive","scope","bindToController","3","./components/rentalcars/rentalcars","./directives/hideDataIfSpaBrands"],"mappings":"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","file":"controllers-flyone.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\nvar app = angular.module('app');\n\napp.filter('trustUrl', ['$sce', function ($sce) {\n    return function (url) {\n        return $sce.trustAsResourceUrl(url);\n    }\n}]);\n\napp.component('rentalcarsIframe', {\n    controllerAs: 'vm',\n    bindings: {\n        orderInfo: '<'\n    },\n    templateUrl: 'components/rentalcars/rentalcars.html',\n    controller: 'rentalcarsIframeCtrl'\n});\n\napp.controller('rentalcarsIframeCtrl', ['$scope', '$sce', 'backend', '$route', 'ROUTES', rentalcarsIframeCtrl]);\n\nfunction rentalcarsIframeCtrl($scope, $sce, backend, $route, ROUTES) {\n    var vm = this;\n\n    vm.baseRentalCarsUrl = 'https://secure.rentalcars.com/WidgetSearch.do?';\n    vm.DEFAULT_PARAMS = {\n        affiliateCode: 'flyone',\n        pickupIATACode: 'KIV',\n        prefcurrency: 'EUR',\n        pickupHour: 12,\n        pickUpMinute: 30,\n        returnHour: 10,\n        returnMinute: 30,\n        pickupDate: 5,\n        pickupMonth: 9,\n        pickupYear: 2018,\n        returnDate: 9,\n        returnMonth: 9,\n        returnYear: 2018,\n        preflang: 'ru',\n        results: 3\n    };\n    vm.SHOW_ON_PAGES = [ROUTES.CONFIRM_ORDER, ROUTES.SEARCH_ORDER, ROUTES.SEARCH_ORDER_WITH_PARAMS];\n    vm.showRentalCarsIframe = false;\n    vm.destionation = null;\n\n    vm.$onInit = function () {\n\n        // don't show iframe in cancelled orders\n        if (vm.orderInfo.header.status !== 'paid') {\n            return;\n        }\n\n        // show only at specific pages (see vm.SHOW_ON_PAGES)\n        if (!_.contains(vm.SHOW_ON_PAGES, $route.current.$$route.originalPath)) {\n            return;\n        }\n\n\n        var newParams = _.clone(vm.DEFAULT_PARAMS),\n            firstFlight = getFlightData(),\n            firstFlightDate = firstFlight.arrivaldate.split('.'),\n            destCity = firstFlight.destinationcity,\n            destPort = firstFlight.destinationport;\n\n        backend.ready.then(function () {\n\n            newParams.pickupIATACode = destCity;\n            newParams.pickupDate = firstFlightDate[0];\n            newParams.pickupMonth = firstFlightDate[1];\n            newParams.pickupYear = firstFlightDate[2];\n            newParams.preflang = backend.sessionParams.lang;\n\n            if (destPort) {\n                newParams.pickupIATACode = destPort;\n            }\n\n            constructUrl(newParams);\n\n            vm.showRentalCarsIframe = true;\n        });\n    };\n\n    function getFlightData() {\n        return vm.orderInfo.plainFlights[0];\n    }\n\n    function constructUrl(params) {\n        var newUrl = 'https://secure.rentalcars.com/WidgetSearch.do?';\n\n        Object.keys(params).map(function (key) {\n            newUrl += key + '=' + params[key] + '&';\n        });\n\n        vm.baseRentalCarsUrl = newUrl;\n    }\n}\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\nangular.module('app').directive('hasSpaBrands', function () {\n    return {\n        scope: false,\n        bindToController: true,\n        controllerAs: 'hasSpaBrands',\n        controller: 'hasSpaBrandsController'\n    }\n});\n\nangular.module('app').controller('hasSpaBrandsController', ['$scope', hasSpaBrandsController]);\n\nfunction hasSpaBrandsController($scope) {\n    var brandList = $scope.vm.searchResult.brandsList;\n\n    $scope.$watch('vm.searchResult', function () {\n        if (!brandList) {\n            return\n        }\n\n        $scope.vm.searchResult.thereIsSPABrands = brandList.reduce(function (acc, brand) {\n            return brand.name.indexOf('SPA') !== -1;\n        }, false);\n\n\n    })\n}\n},{}],3:[function(require,module,exports){\n\"use strict\";\nrequire('./components/rentalcars/rentalcars');\nrequire('./directives/hideDataIfSpaBrands');\n},{\"./components/rentalcars/rentalcars\":1,\"./directives/hideDataIfSpaBrands\":2}]},{},[3]);\n"]}