{"version":3,"sources":["controllers-flyone.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","rentalcarsIframeCtrl","$scope","$sce","backend","$route","ROUTES","getFlightData","vm","orderInfo","plainFlights","constructUrl","params","newUrl","Object","keys","map","key","baseRentalCarsUrl","this","DEFAULT_PARAMS","affiliateCode","pickupIATACode","pickupHour","pickUpMinute","returnHour","returnMinute","pickupDate","pickupMonth","pickupYear","returnDate","returnMonth","returnYear","preflang","results","SHOW_ON_PAGES","CONFIRM_ORDER","SEARCH_ORDER","SEARCH_ORDER_WITH_PARAMS","showRentalCarsIframe","destionation","$onInit","header","status","_","contains","current","$$route","originalPath","newParams","clone","firstFlight","firstFlightDate","arrivaldate","split","destCity","destinationcity","ready","then","sessionParams","lang","app","angular","filter","url","trustAsResourceUrl","component","controllerAs","bindings","templateUrl","controller","2","./components/rentalcars/rentalcars"],"mappings":"CAAA,WAAY,QAASA,GAAEC,EAAEC,EAAEC,GAAG,QAASC,GAAEC,EAAEC,GAAG,IAAIJ,EAAEG,GAAG,CAAC,IAAIJ,EAAEI,GAAG,CAAC,GAAIE,GAAE,kBAAmBC,UAASA,OAAQ,KAAIF,GAAGC,EAAE,MAAOA,GAAEF,GAAE,EAAI,IAAGI,EAAE,MAAOA,GAAEJ,GAAE,EAAI,IAAIK,GAAE,GAAIC,OAAM,uBAAuBN,EAAE,IAAK,MAAMK,GAAEE,KAAK,mBAAmBF,EAAE,GAAIG,GAAEX,EAAEG,IAAIS,WAAYb,GAAEI,GAAG,GAAGU,KAAKF,EAAEC,QAAQ,SAASd,GAAG,GAAIE,GAAED,EAAEI,GAAG,GAAGL,EAAG,OAAOI,GAAEF,GAAGF,IAAIa,EAAEA,EAAEC,QAAQd,EAAEC,EAAEC,EAAEC,GAAG,MAAOD,GAAEG,GAAGS,QAAQ,IAAI,GAAIL,GAAE,kBAAmBD,UAASA,QAAQH,EAAE,EAAEA,EAAEF,EAAEa,OAAOX,IAAID,EAAED,EAAEE,GAAI,OAAOD,GAAE,MAAOJ,OAAOiB,GAAG,SAAST,EAAQU,EAAOJ,GACxe,YAoBA,SAASK,GAAqBC,EAAQC,EAAMC,EAASC,EAAQC,GAwDzD,QAASC,KACL,MAAOC,GAAGC,UAAUC,aAAa,GAGrC,QAASC,GAAaC,GAClB,GAAIC,GAAS,gDAEbC,QAAOC,KAAKH,GAAQI,IAAI,SAAUC,GAC9BJ,GAAUI,EAAM,IAAML,EAAOK,GAAO,MAGxCT,EAAGU,kBAAoBL,EAlE3B,GAAIL,GAAKW,IAETX,GAAGU,kBAAoB,iDACvBV,EAAGY,gBACCC,cAAe,SACfC,eAAgB,MAChBC,WAAY,GACZC,aAAc,GACdC,WAAY,GACZC,aAAc,GACdC,WAAY,EACZC,YAAa,EACbC,WAAY,KACZC,WAAY,EACZC,YAAa,EACbC,WAAY,KACZC,SAAU,KACVC,QAAS,GAEb1B,EAAG2B,eAAiB7B,EAAO8B,cAAe9B,EAAO+B,aAAc/B,EAAOgC,0BACtE9B,EAAG+B,sBAAuB,EAC1B/B,EAAGgC,aAAe,KAElBhC,EAAGiC,QAAU,WAGT,GAAmC,cAA/BjC,EAAGC,UAAUiC,OAAOC,QAKnBC,EAAEC,SAASrC,EAAG2B,cAAe9B,EAAOyC,QAAQC,QAAQC,cAAzD,CAKA,GAAIC,GAAYL,EAAEM,MAAM1C,EAAGY,gBACvB+B,EAAc5C,IACd6C,EAAkBD,EAAYE,YAAYC,MAAM,KAChDC,EAAWJ,EAAYK,eAE3BpD,GAAQqD,MAAMC,KAAK,WAEfT,EAAU3B,eAAiBiC,EAC3BN,EAAUtB,WAAayB,EAAgB,GACvCH,EAAUrB,YAAcwB,EAAgB,GACxCH,EAAUpB,WAAauB,EAAgB,GACvCH,EAAUhB,SAAW7B,EAAQuD,cAAcC,KAE3CjD,EAAasC,GAEbzC,EAAG+B,sBAAuB,MAvEtC,GAAIsB,GAAMC,QAAQ9D,OAAO,MAEzB6D,GAAIE,OAAO,YAAa,OAAQ,SAAU5D,GACtC,MAAO,UAAU6D,GACb,MAAO7D,GAAK8D,mBAAmBD,OAIvCH,EAAIK,UAAU,oBACVC,aAAc,KACdC,UACI3D,UAAW,KAEf4D,YAAa,wCACbC,WAAY,yBAGhBT,EAAIS,WAAW,wBAAyB,SAAU,OAAQ,UAAW,SAAU,SAAUrE,SAyEnFsE,GAAG,SAASjF,EAAQU,EAAOJ,GACjC,YACAN,GAAQ,wCACLkF,qCAAqC,SAAS","file":"controllers-flyone.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\nvar app = angular.module('app');\n\napp.filter('trustUrl', ['$sce', function ($sce) {\n    return function (url) {\n        return $sce.trustAsResourceUrl(url);\n    }\n}]);\n\napp.component('rentalcarsIframe', {\n    controllerAs: 'vm',\n    bindings: {\n        orderInfo: '<'\n    },\n    templateUrl: 'components/rentalcars/rentalcars.html',\n    controller: 'rentalcarsIframeCtrl'\n});\n\napp.controller('rentalcarsIframeCtrl', ['$scope', '$sce', 'backend', '$route', 'ROUTES', rentalcarsIframeCtrl]);\n\nfunction rentalcarsIframeCtrl($scope, $sce, backend, $route, ROUTES) {\n    var vm = this;\n\n    vm.baseRentalCarsUrl = 'https://secure.rentalcars.com/WidgetSearch.do?';\n    vm.DEFAULT_PARAMS = {\n        affiliateCode: 'flyone',\n        pickupIATACode: 'KIV',\n        pickupHour: 12,\n        pickUpMinute: 30,\n        returnHour: 10,\n        returnMinute: 30,\n        pickupDate: 5,\n        pickupMonth: 9,\n        pickupYear: 2018,\n        returnDate: 9,\n        returnMonth: 9,\n        returnYear: 2018,\n        preflang: 'ru',\n        results: 3\n    };\n    vm.SHOW_ON_PAGES = [ROUTES.CONFIRM_ORDER, ROUTES.SEARCH_ORDER, ROUTES.SEARCH_ORDER_WITH_PARAMS];\n    vm.showRentalCarsIframe = false;\n    vm.destionation = null;\n\n    vm.$onInit = function () {\n\n        // don't show iframe in cancelled orders\n        if (vm.orderInfo.header.status === 'cancelled') {\n            return;\n        }\n\n        // show only at specific pages (see vm.SHOW_ON_PAGES)\n        if (!_.contains(vm.SHOW_ON_PAGES, $route.current.$$route.originalPath)) {\n            return;\n        }\n\n\n        var newParams = _.clone(vm.DEFAULT_PARAMS),\n            firstFlight = getFlightData(),\n            firstFlightDate = firstFlight.arrivaldate.split('.'),\n            destCity = firstFlight.destinationcity;\n\n        backend.ready.then(function () {\n\n            newParams.pickupIATACode = destCity;\n            newParams.pickupDate = firstFlightDate[0];\n            newParams.pickupMonth = firstFlightDate[1];\n            newParams.pickupYear = firstFlightDate[2];\n            newParams.preflang = backend.sessionParams.lang;\n\n            constructUrl(newParams);\n\n            vm.showRentalCarsIframe = true;\n        });\n    };\n\n    function getFlightData() {\n        return vm.orderInfo.plainFlights[0];\n    }\n\n    function constructUrl(params) {\n        var newUrl = 'https://secure.rentalcars.com/WidgetSearch.do?';\n\n        Object.keys(params).map(function (key) {\n            newUrl += key + '=' + params[key] + '&';\n        });\n\n        vm.baseRentalCarsUrl = newUrl;\n    }\n}\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\nrequire('./components/rentalcars/rentalcars');\n},{\"./components/rentalcars/rentalcars\":1}]},{},[2]);\n"]}